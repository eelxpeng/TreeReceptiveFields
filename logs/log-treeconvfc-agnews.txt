Running Dataset agnews with [lr=0.001000, epochs=50, batch_size=256]
kernel_stride:  [(6, 5), (5, 4), (5, 2)]
fcwidths:  [100, 50, 25]
Reading data with permutation from dataset/agnews_training_110K_10K-TFIDF-words.txt

Reading data without permutation from dataset/agnews_valid_10K_10K-TFIDF-words.txt

Reading data without permutation from dataset/agnews_test_7600_10K-TFIDF-words.txt

reading data cost:  3.059980630874634
Generating layer units...
===> Number of variables: 10000
===> Computing pairwise mutual_information...
Computing single and joint counts...
Computing MI between variables...
MI computed for 1000 variables...
MI computed for 2000 variables...
MI computed for 3000 variables...
MI computed for 4000 variables...
MI computed for 5000 variables...
MI computed for 6000 variables...
MI computed for 7000 variables...
MI computed for 8000 variables...
MI computed for 9000 variables...
MI computed for 10000 variables...
===> Number of considerred edges: 49995000
===> Running Kruskal's algorithm...
===> Done. Maximum Spanning Tree Generated.
===> Running tree_conv to generate neiborhoods...
===> Mask generated.
Layer hidden units: 2091, Density: 0.022491
=====Denoising Autoencoding layer=======
Loss:  mse
#Epoch 0: Valid Reconstruct Loss: 30.551
#Epoch   0: Reconstruct Loss: 23.641, Valid Reconstruct Loss: 18.123
/home/xlibo/Project/TreeReceptiveFields/lib/maskedDAEwithFC.py:211: UserWarning: invalid index of a 0-dim tensor. This will be an error in PyTorch 0.5. Use tensor.item() to convert a 0-dim tensor to a Python number
  epoch, recon_loss.data[0], valid_loss))
#Epoch   1: Reconstruct Loss: 22.703, Valid Reconstruct Loss: 16.386
#Epoch   2: Reconstruct Loss: 23.360, Valid Reconstruct Loss: 15.417
#Epoch   3: Reconstruct Loss: 22.331, Valid Reconstruct Loss: 15.131
#Epoch   4: Reconstruct Loss: 21.909, Valid Reconstruct Loss: 14.811
#Epoch   5: Reconstruct Loss: 22.788, Valid Reconstruct Loss: 14.695
#Epoch   6: Reconstruct Loss: 21.678, Valid Reconstruct Loss: 14.464
#Epoch   7: Reconstruct Loss: 22.563, Valid Reconstruct Loss: 14.469
#Epoch   8: Reconstruct Loss: 21.750, Valid Reconstruct Loss: 14.247
#Epoch   9: Reconstruct Loss: 22.768, Valid Reconstruct Loss: 14.249
